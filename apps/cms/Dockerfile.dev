# Development Dockerfile for Strapi CMS
FROM node:24-alpine

# Install pnpm
RUN corepack enable && corepack prepare pnpm@10.11.0 --activate

# Set working directory
WORKDIR /app

# Copy package files
COPY package.json pnpm-lock.yaml pnpm-workspace.yaml ./
COPY apps/cms/package.json ./apps/cms/

# Install all dependencies (including dev dependencies)
RUN pnpm install --frozen-lockfile

# Copy application code
COPY apps/cms ./apps/cms

# Expose Strapi port
EXPOSE 1337

# Set working directory to CMS
WORKDIR /app/apps/cms

# Start Strapi in development mode
CMD ["pnpm", "develop"]
